@page "/"
@using System.Net.Http.Json
@using BankBlazor.Client.DTOs
@inject HttpClient Http
@inject NavigationManager Navigation



<PageTitle>Home</PageTitle>

<section class="hero-container">
    <div class="hero-content">
        <img src="/images/hero.jpg" class="hero-img"/>
    </div>
</section>

<section id="greeting" class="container">
    <h2>Welcome to Bank Blazor Admin</h2>
	<p>Here you can view Customer information and manage accounts.</p>
</section>


<section id="dashboard" class="container">
    <h2>Customer Dashboard</h2>

	@if(isLoading)
	{
		<p>Loading customer information...</p>
	}

	else if (customer != null)
	{
		<div class="info">
			<p><strong>Name:</strong> @customer.Name</p>
            <p><strong>Email:</strong> @customer.Email</p>
            <p><strong>Phone:</strong> @customer.Phone</p>
		</div>
	}
	else
	{
		<p>No customer data found.</p>
	}
</section>

<section id="transactions-info" class="container">
	<h2>Account Information</h2>

	@if (customer?.Accounts?.Any() == true)
	{
		var account = customer.Accounts.First();
		
			<div class="account">
				<p><strong>Account ID:</strong> @account.Id</p>
				<p><strong>Balance:</strong> $@account.Balance</p>
			</div>

	<div class="transaction-buttons">
		<button @onclick="@(() => NavigateToTransaction("deposit"))">Deposit</button>
		<button @onclick="@(() => NavigateToTransaction("withdraw"))">Withdraw</button>
		<button @onclick="@(() => NavigateToTransaction("transfer"))">Transfer</button>
		</div>
	}
	else if (!isLoading)
	{
		<p>No accounts found</p>
	}
</section>

@code
{
	private CustomerDTO? customer;
	private bool isLoading = true;

	protected override async Task OnInitializedAsync()
	{
		await LoadCustomerData();
	}

	private async Task LoadCustomerData()
	{
		try
		{
			customer = await Http.GetFromJsonAsync<CustomerDTO>("api/customer/1");
		}
		catch (Exception ex)
		{
			Console.WriteLine($"Error fetching customer data: {ex.Message}");
		}
		finally
		{
			isLoading = false;
		}
	}
	private void NavigateToTransaction(string type)
	{
		// Navigation logic to transaction page
		Navigation.NavigateTo($"/transactions/{type}");
	}
}